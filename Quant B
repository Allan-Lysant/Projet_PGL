import yfinance as yf
import pandas as pd
from typing import List, Tuple

def download_price_data(
    tickers: List[str],
    start: str = "2015-01-01",
    end: str = None,
    interval: str = "1d"
) -> pd.DataFrame:
    """
    Télécharge les prix de clôture ajustés pour une liste de tickers.
    Renvoie un DataFrame avec colonnes = tickers, index = dates.
    """
    data = yf.download(
        tickers=tickers,
        start=start,
        end=end,
        interval=interval,
        auto_adjust=True,
        progress=False
    )
    # yfinance renvoie multiindex si plusieurs champs, on ne garde que Close
    if isinstance(data.columns, pd.MultiIndex):
        data = data["Close"]
    data = data.dropna(how="all")
    return data


def compute_returns(
    prices: pd.DataFrame,
    freq: str = "D"
) -> pd.DataFrame:
    """
    Retourne les rendements log ou simples.
    Ici: rendements simples quotidiens.
    """
    rets = prices.pct_change().dropna()
    return rets
